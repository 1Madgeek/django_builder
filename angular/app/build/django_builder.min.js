function TarballFactory(){return function(){function a(){var a=this,b=require("tar-js"),c=new b;a.uInt8ToString=function(a){var b,c,d="";for(b=0,c=a.length;c>b;b+=1)d+=String.fromCharCode(a[b]);return d},a.append=function(a,b){c.append(a,b)},a.get_url=function(b){var d=btoa(a.uInt8ToString(c.out));return"data:application/tar;base64,"+d}}return new a}}function ModelRenderFactory(){return function(a){var b=this;b.built_in_models=a,b.spaces=function(a){var b=a||1;return new Array(b+1).join(" ")},b.model_names=function(a,b){var c=b||"";return Object.keys(a).map(function(b){return a[b].name+c})},b.new_lines=function(a){var b=a||1;return new Array(b+1).join("\n")},b.render_all=function(a,c){var d="";return d+=b.render_base_html(a,c),d+=b.render_forms_py(a,c),d+=b.render_urls_py(a,c),d+=b.render_admin_py(a,c),d+=b.render_views_py(a,c),d+=b.render_models_py(a,c),d+=b.render_django_rest_framework_api_py(a,c),d+=b.render_django_rest_framework_serializers_py(a,c),d+=b.render_templates_html(a,c)},b.render_base_html=function(a,b){return"<html><head></head><body>{% block content %}Replace this.{% endblock %}</body>"},b.pre_imported_modules=function(a){return{"django.contrib.auth.models":{as:"auth_models"},"django.db.models":{as:"models"},"django_extensions.db.fields":{as:"extension_fields"}}},b.pre_imported_modules_names=function(a){return Object.keys(b.pre_imported_modules())},b.render_forms_py=function(a,c){var d="from django import forms\n";return d+="from .models import "+b.model_names(c,"").join(", ")+"\n",d+=b.new_lines(2),jQuery.each(c,function(c,e){d+=e.render_forms(a,b)}),d},b.render_tests_py=function(a,c){var d="import unittest\nfrom django.core.urlresolvers import reverse\nfrom django.test import Client\n";return d+="from .models import "+b.model_names(c,"").join(", ")+"\n",jQuery.each(b.built_in_models,function(a,c){var e=a.split("."),f=e.pop(),g=e.join(".");d+="from "+g+" import "+f,d+=b.new_lines(1)}),d+=b.new_lines(2),jQuery.each(b.built_in_models,function(a,c){var e="create_"+a.toLowerCase().replace(/\./g,"_"),f=a.split(".").pop(),g="";g+="def "+e+"(**kwargs):\n",g+=b.spaces(4)+"defaults = {}\n",jQuery.each(c.fields,function(a,c){g+=b.spaces(4)+'defaults["'+a+'"] = "'+c["default"]+'"\n'}),g+=b.spaces(4)+"defaults.update(**kwargs)\n",g+=b.spaces(4)+"return "+f+".objects.create(**defaults)\n",g+=b.new_lines(2),d+=g}),jQuery.each(c,function(c,e){d+=e.render_tests_helpers(a,b)}),jQuery.each(c,function(c,e){d+=e.render_tests(a,b)}),d},b.render_urls_py=function(a,c){var d="from django.conf.urls import url, include\n";return d+="from rest_framework import routers"+b.new_lines(1),d+="import api"+b.new_lines(1),d+="import views"+b.new_lines(2),d+="router = routers.DefaultRouter()"+b.new_lines(1),jQuery.each(c,function(a,c){d+="router.register(r'"+c.l_name()+"', api."+c.name+"ViewSet)"+b.new_lines(1)}),d+=b.new_lines(2),d+="urlpatterns = ("+b.new_lines(1),d+=b.spaces(4)+"# urls for Django Rest Framework API"+b.new_lines(1),d+=b.spaces(4)+"url(r'^api/v1/', include(router.urls)),"+b.new_lines(1),d+=")"+b.new_lines(1),d+=b.new_lines(1),jQuery.each(c,function(c,e){d+=e.render_urls(a,b)}),d},b.render_admin_py=function(a,c){var d="from django.contrib import admin\nfrom django import forms\n";return d+="from .models import "+b.model_names(c).join(", "),d+=b.new_lines(2),jQuery.each(c,function(c,e){d+=e.render_admin_classes(a,b)}),d},b.render_views_py=function(a,c){var d="from django.views.generic import DetailView, ListView, UpdateView, CreateView\n";return d+="from .models import "+b.model_names(c).join(", "),d+=b.new_lines(1),d+="from .forms import "+b.model_names(c,"Form").join(", "),d+=b.new_lines(2),jQuery.each(c,function(c,e){d+=e.render_view_classes(a,b)}),d},b.render_models_py=function(a,c){var d="from django.core.urlresolvers import reverse\n";d+="from django_extensions.db.fields import AutoSlugField\n",d+="from django.db.models import *\n",d+="from django.conf import settings\n",d+="from django.contrib.contenttypes.fields import GenericForeignKey\n",d+="from django.contrib.contenttypes.models import ContentType\n",d+="from django.contrib.auth import get_user_model\n",jQuery.each(b.pre_imported_modules(),function(a,b){var c=a.split("."),e=c.pop();d+="from "+c.join(".")+" import "+e+" as "+b.as+"\n"});var e={};jQuery.each(c,function(a,b){jQuery.each(b.fields,function(a,b){e[b.module()]=b.module()})});var f={};return jQuery.each(c,function(a,b){jQuery.each(b.fields,function(a,b){f[b.type]=b}),jQuery.each(b.relationships,function(a,b){f[b.type]=b})}),jQuery.each(f,function(a,b){}),d+=b.new_lines(2),jQuery.each(c,function(c,e){d+=e.render_model_class(a,b)}),d},b.render_templates_html=function(a,b){var c=[];return jQuery.each(b,function(b,d){c.push([d.l_name()+"_form.html",d.render_form_html(a)]),c.push([d.l_name()+"_detail.html",d.render_detail_html(a)]),c.push([d.l_name()+"_list.html",d.render_list_html(a)])}),c},b.render_django_rest_framework_api_py=function(a,c){var d="import models\n";return d+="import serializers\n",d+="from rest_framework import viewsets, permissions\n",d+=b.new_lines(2),jQuery.each(c,function(c,e){d+=e.render_model_api(a,b)}),d},b.render_django_rest_framework_serializers_py=function(a,c){var d="import models";return d+=b.new_lines(2),d+="from rest_framework import serializers",d+=b.new_lines(3),jQuery.each(c,function(c,e){d+=e.render_model_serializer(a,b)}),d}}}function MessageServiceFactory(){return function(){var a=this;a.base_modal=function(){var a=jQuery("<div>").addClass("modal fade");a.attr("tabindex","-1"),a.attr("role","dialog"),a.css("display","none");var b=jQuery("<div>").addClass("modal-dialog"),c=jQuery("<div>").addClass("modal-content").appendTo(b),d=jQuery("<h2>").addClass("modal-header-inner");return jQuery("<div>").addClass("modal-header").appendTo(c).append(d),jQuery("<div>").addClass("modal-body").appendTo(c),jQuery("<div>").addClass("modal-footer").appendTo(c),a.append(b),a},a.icon=function(a){return jQuery("<icon>").addClass("fa").addClass(a)},a.simple_error=function(b,c){var d=a.base_modal(),e=a.icon("fa-info").addClass("pull-right");d.find(".modal-header-inner").append(e).append(jQuery("<span>").text(b)),d.find(".modal-body").empty().append(c);var f=jQuery("<button>").addClass("btn btn-default").text("Ok");return d.find(".modal-footer").append(f),f.attr("data-dismiss","modal"),d.modal(),d},a.simple_info=function(b,c){var d=a.base_modal(),e=a.icon("fa-info").addClass("pull-right");d.find(".modal-header-inner").append(e).append(jQuery("<span>").text(b)),d.find(".modal-body").empty().append(c);var f=jQuery("<button>").addClass("btn btn-default").text("Ok");return d.find(".modal-footer").append(f),f.attr("data-dismiss","modal"),d.modal(),d},a.simple_confirm=function(b,c,d){var e=d||jQuery.noop,f=a.base_modal();f.find(".modal-header-inner").html(b),f.find(".modal-body").empty().append(c);var g=jQuery("<button>").addClass("btn btn-primary").text("Ok"),h=jQuery("<button>").addClass("btn btn-default").text("Cancel");return f.find(".modal-footer").append(g).append(h),g.click(function(){e()}),h.attr("data-dismiss","modal"),g.attr("data-dismiss","modal"),f.modal(),f},a.simple_choice=function(b,c,d){var e=a.base_modal();return e.find(".modal-header-inner").html(b),e.find(".modal-body").empty().append(c),jQuery.each(d,function(a,b){var c=jQuery("<button>").addClass("btn btn-primary").text(b.text);e.find(".modal-footer").append(c),c.click(function(){b.callback()}),c.attr("data-dismiss","modal")}),e.modal(),e},a.simple_form=function(b,c,d,e,f){var g=e||jQuery.noop,h=f||!0,i=a.base_modal();i.find(".modal-header-inner").html(b),i.find(".modal-body").empty().append(c).append(d);var j=jQuery("<button>").addClass("btn btn-primary").text("Ok"),k=jQuery("<button>").addClass("btn btn-default").text("Cancel");return i.find(".modal-footer").append(j).append(k),j.click(function(){h||i.modal("hide"),g(d)}),k.attr("data-dismiss","modal"),h||j.attr("data-dismiss","modal"),i.modal(),i},a.simple_form_no_dismiss=function(b,c,d,e){return a.simple_form(b,c,d,e,!0)},a.simple_input=function(b,c,d,e,f){var g=e||jQuery.noop,h=f||!1,i=a.base_modal();i.find(".modal-header-inner").html(b);var j=jQuery("<label>").text(c),k=jQuery("<input>").attr("type","text").attr("name","input").addClass("form-control").attr("value",d),l=jQuery("<span>").text("error message").addClass("help-block hide"),m=jQuery("<div>").addClass("form-group form-group-input has-feedback").append(j).append(k).append(l),n=function(){var a=k.val();!h||""!=a&&void 0!=k?(i.modal("hide"),g(a)):m.addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text("Field Required")},o=jQuery("<form>").append(m).submit(function(a){a.preventDefault(),n()});i.find(".modal-body").empty().append(o);var p=jQuery("<button>").addClass("btn btn-primary").text("Ok"),q=jQuery("<button>").addClass("btn btn-default").text("Cancel");return i.find(".modal-footer").append(p).append(q),p.click(n),q.attr("data-dismiss","modal"),h||p.attr("data-dismiss","modal"),i.modal(),i}}}function RelationshipFactory(){return function(a){function b(a){this.name=a.name,this.type=a.type,this.opts=a.opts,this.to=a.to,this.external_app=a.external_app||!1,this.class_name=function(){return this.type.split(".").reverse()[0]},this.form_update=function(a){this.name=jQuery(a).find("input[name=name]").val(),this.type=jQuery(a).find("select[name=type]").val(),this.opts=jQuery(a).find("input[name=opts]").val(),this.to=jQuery(a).find("input[name=to]").val()},this.to_clean=function(){return this.to.replace(/['"]+/g,"")},this.to_class=function(){return this.to.split(".").reverse().shift()},this.opts_args=function(){return this.opts.split(",").join(", ")},this.to_module=function(){var a=this.to.split(".");return a.slice(0,a.length-1).join(".")},this.module=function(){var a=this.type.split(".");return a.slice(0,a.length-1).join(".")},this.edit_form=function(a){var b=jQuery("<form>"),c=jQuery("<div>").addClass("form-group form-group-name has-feedback").appendTo(b),d=jQuery("<div>").addClass("form-group form-group-type").appendTo(b),e=jQuery("<div>").addClass("form-group form-group-args").appendTo(b),f=jQuery("<div>").addClass("form-group form-group-args").appendTo(b);c.append(jQuery("<label>").text("Name")),c.append(jQuery("<input>").attr("name","name").addClass("form-control").val(this.name)),c.append(jQuery("<span>").text("error message").addClass("help-block hide")),d.append(jQuery("<label>").text("To")),d.append(jQuery("<input>").attr("name","to").attr("placeholder","to").addClass("form-control").val(this.to));var g=jQuery("<select>").attr("name","type").addClass("form-control"),h=this;return jQuery.each(a.relationship_factory.relationship_types(),function(a,b){var c=jQuery("<option>").attr("val",b).text(b);b==h.type&&c.attr("selected","selected"),g.append(c)}),e.append(jQuery("<label>").text("Field Type")),e.append(g),f.append(jQuery("<label>").text("Arguments")),f.append(jQuery("<input>").attr("name","opts").attr("placeholder","options").addClass("form-control").val(this.args)),b}}var c=this;c.relationship_types=function(){return["django.db.models.ForeignKey","django.db.models.OneToOneField","django.db.models.ManyToManyField"]},c.relationship_matches=function(){return c.relationship_types+["ForeignKey","OneToOneField","ManyToManyField","models.ForeignKey","models.OneToOneField","models.ManyToManyField"]},c.relationship_match=function(a){return-1!=c.relationship_matches().indexOf(a)},c.make_relationship=function(a){return new b(a)}}}function FieldFactory(){return function(a){function b(a){this.name=a.name,this.type=a.type,this.opts=a.opts||"",this.class_name=function(){return this.type.split(".").reverse()[0]},this.opts_args=function(){return this.opts.split(",").join(", ")},this.to_clean=function(){return this.to.replace(/['"]+/g,"")},this.module=function(){var a=this.type.split(".");return a.slice(0,a.length-1).join(".")},this.form_update=function(a){this.name=jQuery(a).find("input[name=name]").val(),this.type=jQuery(a).find("select[name=type]").val(),this.opts=jQuery(a).find("input[name=opts]").val()},this.edit_form=function(a){var b=jQuery("<form>"),c=jQuery("<div>").addClass("form-group form-group-name has-feedback").appendTo(b),d=jQuery("<div>").addClass("form-group form-group-type").appendTo(b),e=jQuery("<div>").addClass("form-group form-group-args").appendTo(b);c.append(jQuery("<label>").text("Name")),c.append(jQuery("<input>").attr("name","name").addClass("form-control").val(this.name)),c.append(jQuery("<span>").text("error message").addClass("help-block hide"));var f=jQuery("<select>").attr("name","type").addClass("form-control"),g=this;return jQuery.each(a.field_factory.field_types(),function(a,b){var c=jQuery("<option>").attr("val",b).text(b);b==g.type&&c.attr("selected","selected"),f.append(c)}),d.append(jQuery("<label>").text("Field Type")),d.append(f),e.append(jQuery("<label>").text("Arguments")),e.append(jQuery("<input>").attr("name","opts").attr("placeholder","options").addClass("form-control").val(this.opts)),b}}var c=this;c.fields=function(){return{"django.db.models.TextField":{default_args:"max_length=100"},"django.db.models.CharField":{default_args:"max_length=30"},"django.contrib.contenttypes.fields.GenericForeignKey":{default_args:'"content_type", "object_id"'},"django_extensions.db.fields.AutoSlugField":{},"django.db.models.CommaSeparatedIntegerField":{},"django.db.models.BigAutoField":{},"django.db.models.BigIntegerField":{},"django.db.models.BooleanField":{},"django.db.models.DateField":{},"django.db.models.DateTimeField":{},"django.db.models.DecimalField":{default_args:"max_digits=10, decimal_places=2"},"django.db.models.DurationField":{},"django.db.models.FilePathField":{},"django.db.models.FloatField":{},"django.db.models.IntegerField":{},"django.db.models.PositiveIntegerField":{},"django.db.models.PositiveSmallIntegerField":{},"django.db.models.SlugField":{},"django.db.models.IPAddressField":{},"django.db.models.GenericIPAddressField":{},"django.db.models.NullBooleanField":{},"django.db.models.TimeField":{},"django.db.models.BinaryField":{},"django.db.models.AutoField":{},"django.db.models.SmallIntegerField":{},"django.db.models.URLField":{},"django.db.models.UUIDField":{},"django.db.models.EmailField":{}}},c.default_field_args=function(a){var b=c.fields()[a];return b&&b.default_args?b.default_args:""},c.field_types=function(){return Object.keys(c.fields())},c.make_field=function(a){return new b(a)}}}function ModelServiceFactory(){return function(a,b){function c(a){this.slugify=function(a){return a.toString().replace(/\s+/g,"").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"").replace(/^-+/,"").replace(/-+$/,"")},this.set_name=function(a){this.name=this.slugify(a)},this.set_name(a.name),this.fields=[];a.fields||[];this.fields=(a.fields||[]).map(b.field_factory.make_field),this.relationships=(a.relationships||[]).map(b.relationship_factory.make_relationship),this.relationship_names=function(){var a=this;return Object.keys(a.relationships).map(function(b){return a.relationships[b].name})},this.field_names=function(){var a=this;return Object.keys(a.fields).map(function(b){return a.fields[b].name})},this.l_name=function(){return this.name.toLowerCase()},this.has_relationship=function(a){return-1!=this.relationship_names().indexOf(a)},this.has_field=function(a){return-1!=this.field_names().indexOf(a)},this.name_field=function(){return-1!=this.field_names().indexOf("name")?"name":"id"},this.ordering_field=function(){return-1!=this.field_names().indexOf("created")?"created":"id"},this.identifier=function(){return-1!=this.field_names().indexOf("slug")?"slug":"id"},this.render_forms=function(a,b){var c="";return c+="class "+this.name+"Form(forms.ModelForm):\n",c+=b.spaces(4)+"class Meta:\n",c+=b.spaces(8)+"model = "+this.name+"\n",this.form_fields()&&(c+=b.spaces(8)+"fields = "+this.form_fields()+"\n"),c+=b.new_lines(2)},this.get_initial_data=function(a,b){var c="{";return c+=b.new_lines(1),jQuery.each(this.readable_fields(),function(a,d){c+=b.spaces(12)+'"'+d.name+'": "'+d.name+'",',c+=b.new_lines(1)}),jQuery.each(this.relationships,function(a,d){c+=b.spaces(12)+'"'+d.name+'": create_'+d.to.toLowerCase().replace(/\./g,"_")+"().id,",c+=b.new_lines(1)}),c+=b.spaces(8)+"}"},this.render_tests_helpers=function(a,b){var c="";return c+="def create_"+this.l_name()+"(**kwargs):\n",c+=b.spaces(4)+"defaults = {}\n",jQuery.each(this.readable_fields(),function(a,d){c+=b.spaces(4)+'defaults["'+d.name+'"] = "'+d.name+'"\n'}),c+=b.spaces(4)+"defaults.update(**kwargs)\n",jQuery.each(this.relationships,function(a,d){c+=b.spaces(4)+'if "'+d.name+'" not in defaults:\n';var e="create_"+d.to.toLowerCase().replace(/\./g,"_");b.built_in_models[d.to]&&(e="create_"+d.to.toLowerCase().replace(/\./g,"_")),c+=b.spaces(8)+'defaults["'+d.name+'"] = '+e+"()\n"}),c+=b.spaces(4)+"return "+this.name+".objects.create(**defaults)\n",c+=b.new_lines(2)},this.render_tests=function(a,b){var c="";return c+="class "+this.name+"ViewTest(unittest.TestCase):\n",c+=b.spaces(4)+"'''\n",c+=b.spaces(4)+"Tests for "+this.name+"\n",c+=b.spaces(4)+"'''\n",c+=b.spaces(4)+"def setUp(self):\n",c+=b.spaces(8)+"self.client = Client()\n",c+=b.new_lines(1),c+=b.spaces(4)+"def test_list_"+this.l_name()+"(self):\n",c+=b.spaces(8)+"url = reverse('"+a+"_"+this.l_name()+"_list')\n",c+=b.spaces(8)+"response = self.client.get(url)\n",c+=b.spaces(8)+"self.assertEqual(response.status_code, 200)\n",c+=b.new_lines(1),c+=b.spaces(4)+"def test_create_"+this.l_name()+"(self):\n",c+=b.spaces(8)+"url = reverse('"+a+"_"+this.l_name()+"_create')\n",c+=b.spaces(8)+"data = "+this.get_initial_data(a,b)+"\n",c+=b.spaces(8)+"response = self.client.post(url, data=data)\n",c+=b.spaces(8)+"self.assertEqual(response.status_code, 302)\n",c+=b.new_lines(1),c+=b.spaces(4)+"def test_detail_"+this.l_name()+"(self):\n",c+=b.spaces(8)+this.l_name()+" = create_"+this.l_name()+"()\n",c+=b.spaces(8)+"url = reverse('"+a+"_"+this.l_name()+"_detail', args=["+this.l_name()+"."+this.identifier()+",])\n",c+=b.spaces(8)+"response = self.client.get(url)\n",c+=b.spaces(8)+"self.assertEqual(response.status_code, 200)\n",c+=b.new_lines(1),c+=b.spaces(4)+"def test_update_"+this.l_name()+"(self):\n",c+=b.spaces(8)+this.l_name()+" = create_"+this.l_name()+"()\n",c+=b.spaces(8)+"data = "+this.get_initial_data(a,b)+"\n",c+=b.spaces(8)+"url = reverse('"+a+"_"+this.l_name()+"_update', args=["+this.l_name()+"."+this.identifier()+",])\n",c+=b.spaces(8)+"response = self.client.post(url, data)\n",c+=b.spaces(8)+"self.assertEqual(response.status_code, 302)\n",c+=b.new_lines(2)},this.render_urls=function(a,b){var c="";return c+="urlpatterns += (\n",c+=b.spaces(4)+"# urls for "+this.name+"\n",c+=b.spaces(4)+"url(r'^"+a+"/"+this.l_name()+"/$', views."+this.name+"ListView.as_view(), name='"+a+"_"+this.l_name()+"_list'),\n",c+=b.spaces(4)+"url(r'^"+a+"/"+this.l_name()+"/create/$', views."+this.name+"CreateView.as_view(), name='"+a+"_"+this.l_name()+"_create'),\n",c+=b.spaces(4)+"url(r'^"+a+"/"+this.l_name()+"/detail/(?P<"+this.identifier()+">\\S+)/$', views."+this.name+"DetailView.as_view(), name='"+a+"_"+this.l_name()+"_detail'),\n",c+=b.spaces(4)+"url(r'^"+a+"/"+this.l_name()+"/update/(?P<"+this.identifier()+">\\S+)/$', views."+this.name+"UpdateView.as_view(), name='"+a+"_"+this.l_name()+"_update'),\n",c+=")\n",c+=b.new_lines(1)},this.render_admin_classes=function(a,b){var c="";c+="class "+this.name+"AdminForm(forms.ModelForm):\n",c+=b.new_lines(1),c+=b.spaces(4)+"class Meta:\n",c+=b.spaces(8)+"model = "+this.name+"\n",c+=b.spaces(8)+"fields = '__all__'\n",c+=b.new_lines(2),c+="class "+this.name+"Admin(admin.ModelAdmin):\n",c+=b.spaces(4)+"form = "+this.name+"AdminForm\n";var d=this.admin_fields();return d.length>0?(c+=b.spaces(4)+"list_display = "+this.admin_fields()+"\n",c+=b.spaces(4)+"readonly_fields = "+this.admin_read_only_fields()+"\n"):c+=b.new_lines(1),c+=b.new_lines(1),c+="admin.site.register("+this.name+", "+this.name+"Admin)\n",c+=b.new_lines(2)},this.render_view_classes=function(a,b){var c=b.new_lines(1);return c+="class "+this.name+"ListView(ListView):\n",c+=b.spaces(4)+"model = "+this.name+"\n",c+=b.new_lines(2),c+="class "+this.name+"CreateView(CreateView):\n",c+=b.spaces(4)+"model = "+this.name+"\n",c+=b.spaces(4)+"form_class = "+this.name+"Form\n",c+=b.new_lines(2),c+="class "+this.name+"DetailView(DetailView):\n",c+=b.spaces(4)+"model = "+this.name+"\n",c+=b.new_lines(2),c+="class "+this.name+"UpdateView(UpdateView):\n",c+=b.spaces(4)+"model = "+this.name+"\n",c+=b.spaces(4)+"form_class = "+this.name+"Form",c+=b.new_lines(2)},this.render_model_class_header=function(a,b){var c="class "+this.name+"(models.Model):";return c+b.new_lines(2)},this.render_model_class_fields=function(a,b){var c="";return this.fields.length>0&&(c+=b.spaces(4)+"# Fields",c+=b.new_lines(1)),jQuery.each(this.fields,function(a,d){if(-1==b.pre_imported_modules_names().indexOf(d.module()))c+=b.spaces(4)+d.name+" = "+d.class_name()+"("+d.opts+")";else{var e=b.pre_imported_modules()[d.module()].as;c+=b.spaces(4)+d.name+" = "+e+"."+d.class_name()+"("+d.opts+")"}c+=b.new_lines(1)}),c+=b.new_lines(1)},this.render_model_class_relationships=function(a,c){var d="";return this.relationships.length>0&&(d+=c.spaces(4)+"# Relationship Fields",d+=c.new_lines(1)),jQuery.each(this.relationships,function(e,f){var g="'"+a+"."+f.to_clean()+"'";if(f.external_app&&(g="'"+f.to_clean()+"'"),f.to==b.user_model?g=b.user_model_setting:c.built_in_models[f.to]&&(g=f.to_class()),-1==c.pre_imported_modules_names().indexOf(f.module()))d+=c.spaces(4)+f.name+" = "+f.class_name()+"("+g+", "+f.opts+")";else{var h=c.pre_imported_modules()[f.module()].as;d+=c.spaces(4)+f.name+" = "+h+"."+f.class_name()+"("+g+", "+f.opts+")"}d+=c.new_lines(1)}),d},this.render_model_class=function(a,b){var c=this.render_model_class_header(a,b);return c+=this.render_model_class_fields(a,b),c+=this.render_model_class_relationships(a,b),c+=b.new_lines(1),c+=b.spaces(4)+"class Meta:",c+=b.new_lines(1),c+=b.spaces(8)+"ordering = ('-"+this.ordering_field()+"',)",c+=b.new_lines(2),c+=b.spaces(4)+"def __unicode__(self):",c+=b.new_lines(1),c+=b.spaces(8)+"return u'%s' % self."+this.identifier(),c+=b.new_lines(2),c+=b.spaces(4)+"def get_absolute_url(self):",c+=b.new_lines(1),c+=b.spaces(8)+"return reverse('"+a+"_"+this.l_name()+"_detail', args=(self."+this.identifier()+",))",c+=b.new_lines(1),c+=b.new_lines(2),c+=b.spaces(4)+"def get_update_url(self):",c+=b.new_lines(1),c+=b.spaces(8)+"return reverse('"+a+"_"+this.l_name()+"_update', args=(self."+this.identifier()+",))",c+=b.new_lines(3)},this.render_model_class_fields_only=function(a,b){var c="";return c+=this.render_model_class_header(a,b),c+=this.render_model_class_fields(a,b)},this.render_model_api=function(a,b){var c="class "+this.name+"ViewSet(viewsets.ModelViewSet):"+b.new_lines(1);return c+=b.spaces(4)+'"""ViewSet for the '+this.name+' class"""',c+=b.new_lines(2),c+=b.spaces(4)+"queryset = models."+this.name+".objects.all()"+b.new_lines(1),c+=b.spaces(4)+"serializer_class = serializers."+this.name+"Serializer"+b.new_lines(1),c+=b.spaces(4)+"permission_classes = [permissions.IsAuthenticated]"+b.new_lines(1),c+=b.new_lines(2)},this.render_model_serializer=function(a,b){var c="class "+this.name+"Serializer(serializers.ModelSerializer):";c+=b.new_lines(2),c+=b.spaces(4)+"class Meta:"+b.new_lines(1),c+=b.spaces(8)+"model = models."+this.name+b.new_lines(1),c+=b.spaces(8)+"fields = ("+b.new_lines(1),c+=b.spaces(12)+"'"+this.identifier()+"', "+b.new_lines(1);var d=this;return jQuery.each(this.fields,function(a,e){e.name!=d.identifier()&&(c+=b.spaces(12)+"'"+e.name+"', "+b.new_lines(1))}),c+=b.spaces(8)+")"+b.new_lines(3)},this._template_header=function(){return'{% extends "base.html" %}\n{% load static %}\n'},this._template_links=function(a){var b=a+"_"+this.l_name()+"_list";return'<p><a class="btn btn-default" href="{% url \''+b+"' %}\">"+this.name+" Listing</a></p>\n"},this._wrap_block=function(a,b){return"{% block "+a+" %}\n"+b+"\n{% endblock %}"},this.render_form_html=function(a){var b=this._template_header();b+="{% load crispy_forms_tags %}\n";var c=this._template_links(a)+'<form method="post">\n';return c+="{% csrf_token %}\n{{form|crispy}}\n",c+='<button class="btn btn-primary" type="submit">Submit</button>\n',c+="</form>",b+=this._wrap_block("content",c)},this.render_list_html=function(a){var b=a+"_"+this.l_name()+"_create",c=this._template_header(),d=this._template_links(a)+'<table class="table">\n';return d+="<tr>\n",d+="<td>ID</td><td>Link</td>\n",jQuery.each(this.fields,function(a,b){d+="    <td>"+b.name+"</td>\n"}),d+="</tr>\n",d+="{% for object in object_list %}\n",d+="<tr>\n",d+="    <td>{{object.id}}</td>\n",d+='    <td><a href="{{object.get_absolute_url}}">{{object}}</a></td>\n',jQuery.each(this.fields,function(a,b){d+="    <td>{{ object."+b.name+" }}</td>\n"}),d+="</tr>\n",d+="{% endfor %}\n",d+="</table>",d+='<a class="btn btn-primary" href="{% url \''+b+"' %}\">Create new "+this.name+"</a>",c+=this._wrap_block("content",d)},this.render_detail_html=function(a){var b=this._template_header(),c=this._template_links(a)+'<table class="table">\n';return jQuery.each(this.fields,function(a,b){c+="<tr><td>"+b.name+"</td><td>{{ object."+b.name+" }}</td></tr>\n"}),c+="</table>",c+='\n<a class="btn btn-primary" href="{{object.get_update_url}}">Edit '+this.name+"</a>\n",b+=this._wrap_block("content",c)},this.form_fields=function(){var a=this.readable_fields().map(function(a){return a.name}),b=this.relationships.map(function(a){return a.name}),c=a.concat(b);return c.length?"['"+c.join("', '")+"']":"'__all__'"},this.readable_fields=function(){var a=[];return jQuery.each(this.fields,function(b,c){-1==c.opts.indexOf("readonly")&&-1==c.opts.indexOf("editable")&&-1==c.opts.indexOf("auto_now_add")&&"django.contrib.contenttypes.fields.GenericForeignKey"!=c.type&&"django_extensions.db.fields.AutoSlugField"!=c.type&&a.push(c)}),a},this.admin_fields=function(){return this.field_names().length>0?"['"+this.field_names().join("', '")+"']":""},this.admin_read_only_fields=function(){return this.field_names().length>0?"['"+this.field_names().join("', '")+"']":""}}return new c(a)}}function ModelParserFactory(){return function(a){function b(){this.parse=function(b,c){var d=new FileReader;d.onload=function(b){var e=d.result,f=e.split("\n"),g=[],h=null,i="",j=new RegExp("class ([a-zA-Z_]*)[(]([a-zA-Z._]*)[)][:]$"),k=new RegExp("^([a-zA-Z0-9_]+) = ([a-zA-Z0-9._]+)[(](.*)[)]$");jQuery.each(f,function(b,c){c=c.trim();var d=j.exec(c);d&&d[2].match(/model/i)&&(console.log("Model:",d[1]),h={name:d[1],"class":d[2],fields:[],relationships:[]},g.push(h),i="");var e,f=k.exec(c);f&&(e=f);var l=k.exec(i);if(l&&(e=l),e){if(h&&e[2]&&(e[2].match(/field/i)||a.relationship_factory.relationship_match(e[2]))){var m=a.relationship_factory.relationship_match(e[2]);if(m){var n=e[1],o=e[2],p=e[3].split(","),q=p.shift(),r=p.join(",").trim();console.log("Model:",h.name,"Relationship:",n,o,q,r),h.relationships.push(a.relationship_factory.make_relationship({name:n,type:o,opts:r,to:q}))}else{var s=e[1],t=e[2],u=e[3];console.log("Model:",h.name,"Field:",s,t,u),h.fields.push(a.field_factory.make_field({name:s,type:t,opts:u}))}}i=""}else h&&(i+=c)});var l=[];jQuery.each(g,function(b,c){var d=a.model_factory(c,a);l.push(d)}),c&&c(l)},d.readAsText(b)}}return new b}}ace.define("ace/mode/python",["require","exports","module","ace/lib/oop","ace/mode/text","ace/tokenizer","ace/mode/python_highlight_rules","ace/mode/folding/pythonic","ace/range"],function(a,b,c){var d=a("../lib/oop"),e=a("./text").Mode,f=(a("../tokenizer").Tokenizer,a("./python_highlight_rules").PythonHighlightRules),g=a("./folding/pythonic").FoldMode,h=a("../range").Range,i=function(){this.HighlightRules=f,this.foldingRules=new g("\\:")};d.inherits(i,e),function(){this.lineCommentStart="#",this.getNextLineIndent=function(a,b,c){var d=this.$getIndent(b),e=this.getTokenizer().getLineTokens(b,a),f=e.tokens;if(f.length&&"comment"==f[f.length-1].type)return d;if("start"==a){var g=b.match(/^.*[\{\(\[\:]\s*$/);g&&(d+=c)}return d};var a={pass:1,"return":1,raise:1,"break":1,"continue":1};this.checkOutdent=function(b,c,d){if("\r\n"!==d&&"\r"!==d&&"\n"!==d)return!1;var e=this.getTokenizer().getLineTokens(c.trim(),b).tokens;if(!e)return!1;do var f=e.pop();while(f&&("comment"==f.type||"text"==f.type&&f.value.match(/^\s+$/)));return f?"keyword"==f.type&&a[f.value]:!1},this.autoOutdent=function(a,b,c){c+=1;var d=this.$getIndent(b.getLine(c)),e=b.getTabString();d.slice(-e.length)==e&&b.remove(new h(c,d.length-e.length,c,d.length))},this.$id="ace/mode/python"}.call(i.prototype),b.Mode=i}),ace.define("ace/mode/python_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(a,b,c){var d=a("../lib/oop"),e=a("./text_highlight_rules").TextHighlightRules,f=function(){var a="and|as|assert|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|not|or|pass|print|raise|return|try|while|with|yield",b="True|False|None|NotImplemented|Ellipsis|__debug__",c="abs|divmod|input|open|staticmethod|all|enumerate|int|ord|str|any|eval|isinstance|pow|sum|basestring|execfile|issubclass|print|super|binfile|iter|property|tuple|bool|filter|len|range|type|bytearray|float|list|raw_input|unichr|callable|format|locals|reduce|unicode|chr|frozenset|long|reload|vars|classmethod|getattr|map|repr|xrange|cmp|globals|max|reversed|zip|compile|hasattr|memoryview|round|__import__|complex|hash|min|set|apply|delattr|help|next|setattr|buffer|dict|hex|object|slice|coerce|dir|id|oct|sorted|intern",d=this.createKeywordMapper({"invalid.deprecated":"debugger","support.function":c,"constant.language":b,keyword:a},"identifier"),e="(?:r|u|ur|R|U|UR|Ur|uR)?",f="(?:(?:[1-9]\\d*)|(?:0))",g="(?:0[oO]?[0-7]+)",h="(?:0[xX][\\dA-Fa-f]+)",i="(?:0[bB][01]+)",j="(?:"+f+"|"+g+"|"+h+"|"+i+")",k="(?:[eE][+-]?\\d+)",l="(?:\\.\\d+)",m="(?:\\d+)",n="(?:(?:"+m+"?"+l+")|(?:"+m+"\\.))",o="(?:(?:"+n+"|"+m+")"+k+")",p="(?:"+o+"|"+n+")",q="\\\\(x[0-9A-Fa-f]{2}|[0-7]{3}|[\\\\abfnrtv'\"]|U[0-9A-Fa-f]{8}|u[0-9A-Fa-f]{4})";this.$rules={start:[{token:"comment",regex:"#.*$"},{token:"string",regex:e+'"{3}',next:"qqstring3"},{token:"string",regex:e+'"(?=.)',next:"qqstring"},{token:"string",regex:e+"'{3}",next:"qstring3"},{token:"string",regex:e+"'(?=.)",next:"qstring"},{token:"constant.numeric",regex:"(?:"+p+"|\\d+)[jJ]\\b"},{token:"constant.numeric",regex:p},{token:"constant.numeric",regex:j+"[lL]\\b"},{token:"constant.numeric",regex:j+"\\b"},{token:d,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"\\+|\\-|\\*|\\*\\*|\\/|\\/\\/|%|<<|>>|&|\\||\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\[\\(\\{]"},{token:"paren.rparen",regex:"[\\]\\)\\}]"},{token:"text",regex:"\\s+"}],qqstring3:[{token:"constant.language.escape",regex:q},{token:"string",regex:'"{3}',next:"start"},{defaultToken:"string"}],qstring3:[{token:"constant.language.escape",regex:q},{token:"string",regex:"'{3}",next:"start"},{defaultToken:"string"}],qqstring:[{token:"constant.language.escape",regex:q},{token:"string",regex:"\\\\$",next:"qqstring"},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],qstring:[{token:"constant.language.escape",regex:q},{token:"string",regex:"\\\\$",next:"qstring"},{token:"string",regex:"'|$",next:"start"},{defaultToken:"string"}]}};d.inherits(f,e),b.PythonHighlightRules=f}),ace.define("ace/mode/folding/pythonic",["require","exports","module","ace/lib/oop","ace/mode/folding/fold_mode"],function(a,b,c){var d=a("../../lib/oop"),e=a("./fold_mode").FoldMode,f=b.FoldMode=function(a){this.foldingStartMarker=new RegExp("([\\[{])(?:\\s*)$|("+a+")(?:\\s*)(?:#.*)?$")};d.inherits(f,e),function(){this.getFoldWidgetRange=function(a,b,c){var d=a.getLine(c),e=d.match(this.foldingStartMarker);return e?e[1]?this.openingBracketBlock(a,e[1],c,e.index):e[2]?this.indentationBlock(a,c,e.index+e[2].length):this.indentationBlock(a,c):void 0;
}}.call(f.prototype)}),ace.define("ace/theme/dawn",["require","exports","module","ace/lib/dom"],function(a,b,c){b.isDark=!1,b.cssClass="ace-dawn",b.cssText=".ace-dawn .ace_gutter {background: #ebebeb;color: #333}.ace-dawn .ace_print-margin {width: 1px;background: #e8e8e8}.ace-dawn {background-color: #F9F9F9;color: #080808}.ace-dawn .ace_cursor {color: #000000}.ace-dawn .ace_marker-layer .ace_selection {background: rgba(39, 95, 255, 0.30)}.ace-dawn.ace_multiselect .ace_selection.ace_start {box-shadow: 0 0 3px 0px #F9F9F9;border-radius: 2px}.ace-dawn .ace_marker-layer .ace_step {background: rgb(255, 255, 0)}.ace-dawn .ace_marker-layer .ace_bracket {margin: -1px 0 0 -1px;border: 1px solid rgba(75, 75, 126, 0.50)}.ace-dawn .ace_marker-layer .ace_active-line {background: rgba(36, 99, 180, 0.12)}.ace-dawn .ace_gutter-active-line {background-color : #dcdcdc}.ace-dawn .ace_marker-layer .ace_selected-word {border: 1px solid rgba(39, 95, 255, 0.30)}.ace-dawn .ace_invisible {color: rgba(75, 75, 126, 0.50)}.ace-dawn .ace_keyword,.ace-dawn .ace_meta {color: #794938}.ace-dawn .ace_constant,.ace-dawn .ace_constant.ace_character,.ace-dawn .ace_constant.ace_character.ace_escape,.ace-dawn .ace_constant.ace_other {color: #811F24}.ace-dawn .ace_invalid.ace_illegal {text-decoration: underline;font-style: italic;color: #F8F8F8;background-color: #B52A1D}.ace-dawn .ace_invalid.ace_deprecated {text-decoration: underline;font-style: italic;color: #B52A1D}.ace-dawn .ace_support {color: #691C97}.ace-dawn .ace_support.ace_constant {color: #B4371F}.ace-dawn .ace_fold {background-color: #794938;border-color: #080808}.ace-dawn .ace_list,.ace-dawn .ace_markup.ace_list,.ace-dawn .ace_support.ace_function {color: #693A17}.ace-dawn .ace_storage {font-style: italic;color: #A71D5D}.ace-dawn .ace_string {color: #0B6125}.ace-dawn .ace_string.ace_regexp {color: #CF5628}.ace-dawn .ace_comment {font-style: italic;color: #5A525F}.ace-dawn .ace_heading,.ace-dawn .ace_markup.ace_heading {color: #19356D}.ace-dawn .ace_variable {color: #234A97}.ace-dawn .ace_indent-guide {background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYLh/5+x/AAizA4hxNNsZAAAAAElFTkSuQmCC) right repeat-y}";var d=a("../lib/dom");d.importCssString(b.cssText,b.cssClass)});var global=Function("return this;")();!function(a){function b(a){var b=g[a]||window[a];if(!b)throw new Error("Requested module '"+a+"' has not been defined.");return b}function c(a,b){return g[a]=b}function d(a,b){for(var c in b)"noConflict"!=c&&"_VERSION"!=c&&(a[c]=b[c]);return a}function e(a,b,c){return"string"==typeof a||a.nodeName||a.length&&"item"in a||a==window?(c=f._select(a,b),c.selector=a):c=isFinite(a.length)?a:[a],d(c,e)}function f(a,b){return e(a,b)}a.global=a;var g={},h=a.$;a.provide=c,a.require=b,d(f,{_VERSION:"0.3.6",fn:e,ender:function(a,b){d(b?e:f,a)},_select:function(a,b){return(b||document).querySelectorAll(a)}}),d(e,{forEach:function(a,b,c){for(c=0,l=this.length;c<l;++c)c in this&&a.call(b||this[c],this[c],c,this);return this},$:f}),f.noConflict=function(){return a.$=h,this},"undefined"!=typeof module&&module.exports&&(module.exports=f),a.ender=a.$=a.ender||f}(this),function(a){var b={exports:{}};b.exports,require("ender");!function(){"use strict";function a(a){var b,c=new Uint8Array(a);for(b=0;a>b;b+=1)c[b]=0;return c}function c(b,c,d,e){var f=c+d,g=a((parseInt(f/e)+1)*e);return g.set(b),g}function d(a,b,c){return a=a.toString(c||8),"000000000000".substr(a.length+12-b)+a}function e(b,c,d){var e,f;for(c=c||a(b.length),d=d||0,e=0,f=b.length;f>e;e+=1)c[d]=b.charCodeAt(e),d+=1;return c}function f(a){function b(a){return g[a>>18&63]+g[a>>12&63]+g[a>>6&63]+g[63&a]}var c,d,e,f=a.length%3,h="";for(c=0,e=a.length-f;e>c;c+=3)d=(a[c]<<16)+(a[c+1]<<8)+a[c+2],h+=b(d);switch(h.length%4){case 1:h+="=";break;case 2:h+="=="}return h}var g=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];b.exports.clean=a,b.exports.pad=d,b.exports.extend=c,b.exports.stringToUint8=e,b.exports.uint8ToBase64=f}(),provide("tar-js/utils",b.exports)}(global),function(a){var b={exports:{}};b.exports,require("ender");!function(){"use strict";function a(a,b){var e=d.clean(512),f=0;return c.forEach(function(b){var c,d,g=a[b.field]||"";for(c=0,d=g.length;d>c;c+=1)e[f]=g.charCodeAt(c),f+=1;f+=b.length-c}),"function"==typeof b?b(e,f):e}var c,d=require("tar-js/utils");c=[{field:"fileName",length:100},{field:"fileMode",length:8},{field:"uid",length:8},{field:"gid",length:8},{field:"fileSize",length:12},{field:"mtime",length:12},{field:"checksum",length:8},{field:"type",length:1},{field:"linkName",length:100},{field:"ustar",length:8},{field:"owner",length:32},{field:"group",length:32},{field:"majorNumber",length:8},{field:"minorNumber",length:8},{field:"filenamePrefix",length:155},{field:"padding",length:12}],b.exports.structure=c,b.exports.format=a}(),provide("tar-js/header",b.exports)}(global),function(a){var b={exports:{}};b.exports,require("ender");!function(){"use strict";function a(a){this.written=0,c=(a||20)*f,this.out=e.clean(c)}var c,d=require("tar-js/header"),e=require("tar-js/utils"),f=512;a.prototype.append=function(a,b,g,h){var i,j,k,l,m,n,o;if("string"==typeof b)b=e.stringToUint8(b);else if(b.constructor!==Uint8Array.prototype.constructor)throw"Invalid input type. You gave me: "+b.constructor.toString().match(/function\s*([$A-Za-z_][0-9A-Za-z_]*)\s*\(/)[1];"function"==typeof g&&(h=g,g={}),g=g||{},k=g.mode||4095&parseInt("777",8),l=g.mtime||Math.floor(+new Date/1e3),m=g.uid||0,n=g.gid||0,i={fileName:a,fileMode:e.pad(k,7),uid:e.pad(m,7),gid:e.pad(n,7),fileSize:e.pad(b.length,11),mtime:e.pad(l,11),checksum:"        ",type:"0",ustar:"ustar  ",owner:g.owner||"",group:g.group||""},j=0,Object.keys(i).forEach(function(a){var b,c,d=i[a];for(b=0,c=d.length;c>b;b+=1)j+=d.charCodeAt(b)}),i.checksum=e.pad(j,6)+"\x00 ",o=d.format(i);return this.out.set(o,this.written),this.written+=o.length,this.written+b.length>this.out.length&&(this.out=e.extend(this.out,this.written,b.length,c)),this.out.set(b,this.written),this.written+=b.length+(f-(b.length%f||f)),this.out.length-this.written<2*f&&(this.out=e.extend(this.out,this.written,2*f,c)),"function"==typeof h&&h(this.out),this.out},a.prototype.clear=function(){this.written=0,this.out=e.clean(c)},b.exports=a}(),provide("tar-js",b.exports)}(global),angular.module("ui.ace",[]).constant("uiAceConfig",{}).directive("uiAce",["uiAceConfig",function(a){if(angular.isUndefined(window.ace))throw new Error("ui-ace need ace to work... (o rly?)");var b=function(a,b,c){if(angular.isDefined(c.workerPath)){var d=window.ace.require("ace/config");d.set("workerPath",c.workerPath)}angular.isDefined(c.require)&&c.require.forEach(function(a){window.ace.require(a)}),angular.isDefined(c.showGutter)&&a.renderer.setShowGutter(c.showGutter),angular.isDefined(c.useWrapMode)&&b.setUseWrapMode(c.useWrapMode),angular.isDefined(c.showInvisibles)&&a.renderer.setShowInvisibles(c.showInvisibles),angular.isDefined(c.showIndentGuides)&&a.renderer.setDisplayIndentGuides(c.showIndentGuides),angular.isDefined(c.useSoftTabs)&&b.setUseSoftTabs(c.useSoftTabs),angular.isDefined(c.showPrintMargin)&&a.setShowPrintMargin(c.showPrintMargin),angular.isDefined(c.disableSearch)&&c.disableSearch&&a.commands.addCommands([{name:"unfind",bindKey:{win:"Ctrl-F",mac:"Command-F"},exec:function(){return!1},readOnly:!0}]),angular.isString(c.theme)&&a.setTheme("ace/theme/"+c.theme),angular.isString(c.mode)&&b.setMode("ace/mode/"+c.mode),angular.isDefined(c.firstLineNumber)&&(angular.isNumber(c.firstLineNumber)?b.setOption("firstLineNumber",c.firstLineNumber):angular.isFunction(c.firstLineNumber)&&b.setOption("firstLineNumber",c.firstLineNumber()));var e,f;if(angular.isDefined(c.advanced))for(e in c.advanced)f={name:e,value:c.advanced[e]},a.setOption(f.name,f.value);if(angular.isDefined(c.rendererOptions))for(e in c.rendererOptions)f={name:e,value:c.rendererOptions[e]},a.renderer.setOption(f.name,f.value);angular.forEach(c.callbacks,function(b){angular.isFunction(b)&&b(a)})};return{restrict:"EA",require:"?ngModel",link:function(c,d,e,f){var g,h,i=a.ace||{},j=angular.extend({},i,c.$eval(e.uiAce)),k=window.ace.edit(d[0]),l=k.getSession(),m=function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);angular.isDefined(a)&&c.$evalAsync(function(){if(!angular.isFunction(a))throw new Error("ui-ace use a function as callback.");a(b)})},n={onChange:function(a){return function(b){var d=l.getValue();!f||d===f.$viewValue||c.$$phase||c.$root.$$phase||c.$evalAsync(function(){f.$setViewValue(d)}),m(a,b,k)}},onBlur:function(a){return function(){m(a,k)}}};e.$observe("readonly",function(a){k.setReadOnly(!!a||""===a)}),f&&(f.$formatters.push(function(a){if(angular.isUndefined(a)||null===a)return"";if(angular.isObject(a)||angular.isArray(a))throw new Error("ui-ace cannot use an object or an array as a model");return a}),f.$render=function(){l.setValue(f.$viewValue)});var o=function(a,d){a!==d&&(j=angular.extend({},i,c.$eval(e.uiAce)),j.callbacks=[j.onLoad],j.onLoad!==i.onLoad&&j.callbacks.unshift(i.onLoad),l.removeListener("change",g),g=n.onChange(j.onChange),l.on("change",g),k.removeListener("blur",h),h=n.onBlur(j.onBlur),k.on("blur",h),b(k,l,j))};c.$watch(e.uiAce,o,!0),o(i),d.on("$destroy",function(){k.session.$stopWorker(),k.destroy()}),c.$watch(function(){return[d[0].offsetWidth,d[0].offsetHeight]},function(){k.resize(),k.renderer.updateFull()},!0)}}}]),!function(a,b){"use strict";var c=b.isDefined,d=b.isUndefined,e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson,j=b.module("LocalStorageModule",[]);j.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(a){return this.prefix=a,this},this.setStorageType=function(a){return this.storageType=a,this},this.setStorageCookie=function(a,b){return this.cookie.expiry=a,this.cookie.path=b,this},this.setStorageCookieDomain=function(a){return this.cookie.domain=a,this},this.setNotify=function(a,b){return this.notify={setItem:a,removeItem:b},this},this.$get=["$rootScope","$window","$document","$parse",function(a,b,j,k){var l,m=this,n=m.prefix,o=m.cookie,p=m.notify,q=m.storageType;j?j[0]&&(j=j[0]):j=document,"."!==n.substr(-1)&&(n=n?n+".":"");var r=function(a){return n+a},s=function(){try{var c=q in b&&null!==b[q],d=r("__"+Math.round(1e7*Math.random()));return c&&(l=b[q],l.setItem(d,""),l.removeItem(d)),c}catch(e){return q="cookie",a.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),t=function(b,c){if(c=d(c)?null:i(c),!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),z(b,c);try{l&&l.setItem(r(b),c),p.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:m.storageType})}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.message),z(b,c)}return!0},u=function(b){if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(b);var c=l?l.getItem(r(b)):null;if(!c||"null"===c)return null;try{return JSON.parse(c)}catch(d){return c}},v=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],s&&"cookie"!==m.storageType)try{l.removeItem(r(c)),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:m.storageType})}catch(d){a.$broadcast("LocalStorageModule.notification.error",d.message),B(c)}else s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),B(c)},w=function(){if(!s)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var b=n.length,c=[];for(var d in l)if(d.substr(0,b)===n)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return c},x=function(b){var c=n?new RegExp("^"+n):new RegExp,d=b?new RegExp(b):new RegExp;if(!s||"cookie"===m.storageType)return s||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C();var e=n.length;for(var f in l)if(c.test(f)&&d.test(f.substr(e)))try{v(f.substr(e))}catch(g){return a.$broadcast("LocalStorageModule.notification.error",g.message),C()}return!0},y=function(){try{return b.navigator.cookieEnabled||"cookie"in j&&(j.cookie.length>0||(j.cookie="test").indexOf.call(j.cookie,"test")>-1)}catch(c){return a.$broadcast("LocalStorageModule.notification.error",c.message),!1}}(),z=function(b,c,h){if(d(c))return!1;if((g(c)||f(c))&&(c=i(c)),!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var k="",l=new Date,m="";if(null===c?(l.setTime(l.getTime()+-864e5),k="; expires="+l.toGMTString(),c=""):e(h)&&0!==h?(l.setTime(l.getTime()+24*h*60*60*1e3),k="; expires="+l.toGMTString()):0!==o.expiry&&(l.setTime(l.getTime()+24*o.expiry*60*60*1e3),k="; expires="+l.toGMTString()),b){var n="; path="+o.path;o.domain&&(m="; domain="+o.domain),j.cookie=r(b)+"="+encodeURIComponent(c)+k+n+m}}catch(p){return a.$broadcast("LocalStorageModule.notification.error",p.message),!1}return!0},A=function(b){if(!y)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var c=j.cookie&&j.cookie.split(";")||[],d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(r(b)+"=")){var f=decodeURIComponent(e.substring(n.length+b.length+1,e.length));try{return JSON.parse(f)}catch(g){return f}}}return null},B=function(a){z(a,null)},C=function(){for(var a=null,b=n.length,c=j.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);var e=a.substring(b,a.indexOf("="));B(e)}},D=function(){return q},E=function(a,b,d,e){e=e||b;var g=u(e);return null===g&&c(d)?g=d:f(g)&&f(d)&&(g=h(d,g)),k(b).assign(a,g),a.$watch(b,function(a){t(e,a)},f(a[b]))},F=function(){for(var a=0,c=b[q],d=0;d<c.length;d++)0===c.key(d).indexOf(n)&&a++;return a};return{isSupported:s,getStorageType:D,set:t,add:t,get:u,keys:w,remove:v,clearAll:x,bind:E,deriveKey:r,length:F,cookie:{isSupported:y,set:z,add:z,get:A,remove:B,clearAll:C}}}]})}(window,window.angular),angular.module("builder",["ngRoute","builder.filters","builder.services","builder.directives","builder.controllers","LocalStorageModule","ui.ace","angulartics","angulartics.google.analytics"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/models",{templateUrl:"partials/models.html",controller:"ModelController"}),a.when("/home",{templateUrl:"partials/home.html",controller:"ModelController"}),a.otherwise({redirectTo:"/home"})}]),angular.module("builder.controllers",["LocalStorageModule"]).controller("ModelController",["$scope","$http","ModelFactory","ModelParser","FieldFactory","RelationshipFactory","localStorageService","MessageService","RenderFactory","TarballFactory",function(a,b,c,d,e,f,g,h,i,j){a.models=[],a.new_models=[],a.user_model="django.contrib.auth.models.User",a.user_model_setting="settings.AUTH_USER_MODEL",a.built_in_models={"django.contrib.auth.models.User":{fields:{username:{"default":"username"},email:{"default":"username@tempurl.com"}}},"django.contrib.auth.models.Group":{fields:{name:{"default":"group"}}},"django.contrib.contenttypes.models.ContentType":{fields:{}}},a.messageService=new h,a.field_factory=new e,a.model_factory=c,a.relationship_factory=new f,a.render_factory=new i(a.built_in_models),a.editors=[],a.models_storage_key="local_models",a._app_name="app_name",a.create_tar_ball_url=function(){var b="Built with django_builder\n",c="#",d=a.render_factory.render_models_py(a.app_name(),a.models),e=a.render_factory.render_views_py(a.app_name(),a.models),f=a.render_factory.render_admin_py(a.app_name(),a.models),g=a.render_factory.render_urls_py(a.app_name(),a.models),h=a.render_factory.render_tests_py(a.app_name(),a.models),i=a.render_factory.render_forms_py(a.app_name(),a.models),k=a.render_factory.render_django_rest_framework_api_py(a.app_name(),a.models),l=a.render_factory.render_django_rest_framework_serializers_py(a.app_name(),a.models),m=a.render_factory.render_templates_html(a.app_name(),a.models),n=new j;return n.append("README.txt",b),n.append(a.app_name()+"/__init__.py",c),n.append(a.app_name()+"/models.py",d),n.append(a.app_name()+"/views.py",e),n.append(a.app_name()+"/admin.py",f),n.append(a.app_name()+"/urls.py",g),n.append(a.app_name()+"/tests.py",h),n.append(a.app_name()+"/forms.py",i),n.append(a.app_name()+"/api.py",k),n.append(a.app_name()+"/serializers.py",l),n.append(a.app_name()+"/templates/base.html",a.render_factory.render_base_html(a.app_name(),a.models)),jQuery.each(m,function(b,c){n.append(a.app_name()+"/templates/"+a.app_name()+"/"+c[0],c[1])}),n.get_url()},a.create_download_modal=function(){var b=a.create_tar_ball_url(),c=a.app_name()+".tar",d=jQuery("<a>").attr("href",b).attr("id","django_builder_download_a");d.addClass("btn btn-success btn-lg").css("text-transform","none"),d.text("Click here to download "+c),d.attr("download",c);var e=jQuery("<div>").addClass("text-center").append(d),f=jQuery("<div>");f.append(jQuery("<br>")),f.append("Chrome can block downloads of the generated tarball, if this happens navigate to the "),f.append(jQuery("<strong>").text("Downloads")),f.append(" section of chrome to accept the download"),f.append(jQuery("<br>")),f.append("Window -> Downloads");var g=jQuery("<div>");g.append(e),g.append(f);var h="django_builder_download_modal";return a.messageService.simple_info("Download info",g).modal("show").attr("id",h),h},a.render_model_class_fields_only=function(b){return b.render_model_class_fields_only(a._app_name,a.render_factory)},a.upload_input=function(){return jQuery('<input type="file" />')},a.upload_drop_target=function(a){var b=jQuery("<div>").addClass("builder_dnd_target text-center"),c=jQuery("<i>").addClass("fa fa-upload fa-4x builder_dnd_icon");return b.append(jQuery("<div>").text("Drag and Drop files here!")),b.append(c),b},a.upload_form=function(a,b){var c=jQuery("<form>"),d=jQuery("<span>").addClass("btn btn-default btn-file center-block builder_upload_models_py");return d.append("Browse"),d.append(a),c.append(d),c.append(b),c},a.save_new_models=function(b){a.new_models=[],a.models=b,a.saveApp(),a.$apply()},a.merge_models=function(){for(var b=a.models.concat(a.new_models),c=0;c<b.length;++c)for(var d=c+1;d<b.length;++d)b[c].name===b[d].name&&b.splice(d--,1);return a.save_new_models(b)},a.add_unique=function(){jQuery.each(a.new_models,function(b,c){a.existingModel(c.name)||a.models.push(c)}),a.save_new_models(a.models)},a.add_new_models=function(b){a.new_models=b,a.$apply();var c=function(){console.log("Overwriting existing models"),a.merge_models()},d=function(){var b=!1,d=[],e=jQuery("<p>").text("The following models are duplicates:");jQuery.each(a.new_models,function(c,f){a.existingModel(f.name)&&(b=!0,d.push(f),e.append(jQuery("<div>").text(f.name)))});var f=d.length==a.new_models.length;if(b){var g=[{text:"Overwrite existing models",callback:c}];f||g.push({text:"Add unique",callback:a.add_unique}),g.push({text:"Cancel",callback:function(){}});var h="duplicate_models";a.messageService.simple_choice("Add duplicate models?",e,g).modal("show").attr("id",h)}else a.merge_models()},e=jQuery("<div>");jQuery.each(a.new_models,function(b,c){e.append(jQuery("<hr>")),e.append(jQuery("<pre>").html(c.render_model_class_fields_only(a._app_name,a.render_factory)));var d=jQuery('<button class="btn btn-danger pull-right">').text("Remove");e.append(d),e.append(jQuery("<div>").addClass("clearfix"))});var f="add_new_models";return a.messageService.simple_confirm("Add the following models?",jQuery("#builder_new_models"),d).modal("show").find(".modal-dialog").css("width","50%").attr("id",f),f},a.process_models_py=function(b){if(0==b.length)a.messageService.simple_error("Sorry","You didn't seem to choose any files.").modal("show");else if(b.length>1)a.messageService.simple_error("Sorry","Multiple files not yet supported, please choose a single file.").modal("show");else{var c=d(a);c.parse(b[0],function(b){a.add_new_models(b)})}},a.upload_models_py=function(){var b=a.upload_input(),c=a.upload_drop_target(),d=a.upload_form(b,c),e=a.messageService.simple_form("Upload models.py","Choose a models.py file to analyse",d,function(){a.process_models_py(jQuery(b)[0].files),e.modal("hide")}).modal("show");b.change(function(){a.process_models_py(jQuery(b)[0].files),e.modal("hide")}),d.on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("dragover dragenter",function(){c.addClass("is-drag-over")}).on("dragleave dragend drop",function(){c.removeClass("is-drag-over")}).on("drop",function(b){var c=b.originalEvent.dataTransfer.files;e.modal("hide"),a.process_models_py(c)})},jQuery("html body").on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("dragover dragenter",function(){}).on("drop",function(a){}),jQuery("#builder_models_content").on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault(),a.stopPropagation()}).on("dragover dragenter",function(){jQuery(".builder_dnd_target").addClass("is-drag-over")}).on("drop",function(b){jQuery(".builder_dnd_target").removeClass("is-drag-over");var c=b.originalEvent.dataTransfer.files;a.process_models_py(c)}),a.aceLoad=function(b){var c=jQuery(b.container).attr("id");"builder_models"==c?b.setValue(a.render_factory.render_models_py(a.app_name(),a.models)):"builder_views"==c?b.setValue(a.render_factory.render_views_py(a.app_name(),a.models)):"builder_admin"==c?b.setValue(a.render_factory.render_admin_py(a.app_name(),a.models)):"builder_urls"==c?b.setValue(a.render_factory.render_urls_py(a.app_name(),a.models)):"builder_tests"==c?b.setValue(a.render_factory.render_tests_py(a.app_name(),a.models)):"builder_forms"==c?b.setValue(a.render_factory.render_forms_py(a.app_name(),a.models)):"builder_django_rest_framework_api"==c?b.setValue(a.render_factory.render_django_rest_framework_api_py(a.app_name(),a.models)):"builder_django_rest_framework_serializers"==c&&b.setValue(a.render_factory.render_django_rest_framework_serializers_py(a.app_name(),a.models)),b.session.selection.clearSelection()},a.reLoadAce=function(){Object.keys(a.editors).map(function(b){a.aceLoad(a.editors[b])})},a.aceLoaded=function(b){b.setOptions({readOnly:!0,highlightActiveLine:!1,highlightGutterLine:!1,maxLines:1/0}),b.renderer.$cursorLayer.element.style.opacity=0,a.aceLoad(b),a.editors.push(b)},a.$watch("[models,_app_name]",function(){a.reLoadAce(),a.saveApp()},!0),a.aceChanged=function(a){},a.do_set_app_name=function(b){a._app_name=b},a.set_app_name=function(){a.do_set_app_name(jQuery("input#appname").val()),a.reLoadAce()},a.l_app_name=function(){return a._app_name.toLowerCase()},a.app_name=function(){return a._app_name.replace(new RegExp(" ","g"),"_")},a.updateModel=function(b){var c=a.models.indexOf(b);a.models[c]=b,a.$apply()},a.serializeApp=function(){var b={models:a.models,app_config:{app_name:a._app_name}};return JSON.stringify(b)},a.saveApp=function(){g.set(a.models_storage_key,a.serializeApp())},a.doClearModels=function(){g.set(a.models_storage_key,""),a.loadModels(),a.models=[],a.$apply()},a.clearModels=function(){var b=function(){a.doClearModels()},c="clear_all";return a.messageService.simple_confirm("Confirm","Remove all models?",b).modal("show").attr("id",c),c},a.model_count=function(){return a.models.length},a.add_model=function(b){var d={name:b};d.fields=[a.field_factory.make_field({name:"name",type:"django.db.models.CharField",opts:"max_length=255"}),a.field_factory.make_field({name:"slug",type:"django_extensions.db.fields.AutoSlugField",opts:"populate_from='name', blank=True"}),a.field_factory.make_field({name:"created",type:"django.db.models.DateTimeField",opts:"auto_now_add=True, editable=False"}),a.field_factory.make_field({name:"last_updated",type:"django.db.models.DateTimeField",opts:"auto_now=True, editable=False"})];var e=c(d,a);a.models.push(e),a.saveApp(),a.$apply()},a.existingModel=function(b){var c=!1;return jQuery.each(a.models,function(a,d){b==d.name&&(c=!0)}),c},a.addModel=function(){var b=function(b){void 0==b||""===b?a.messageService.simple_info("Model Name Required","Enter a Model name").modal("show"):a.existingModel(b)?a.messageService.simple_error("Error with Model Name","There is already a model with the name "+b).modal("show"):a.add_model(b)},c="add_model";return a.messageService.simple_input("Model Name Required","Enter a Model name","Model1",b,!0).modal("show").attr("id",c),c},a.cleanModel=function(a){delete a.$$hashKey,void 0!=a.fields&&jQuery.each(a.fields,function(a,b){delete b.$$hashKey}),void 0!=a.relationships&&jQuery.each(a.relationships,function(a,b){delete b.$$hashKey})},a.loadModels=function(){var b=g.get(a.models_storage_key)||{models:[],app_config:{app_name:"app_name"}};"string"==typeof b&&(b=JSON.parse(b));var c=b.models||[],d=b.app_config||{app_name:"app_name"};return a._app_name=d.app_name,jQuery.each(c,function(b,c){a.cleanModel(c)}),c},a.loadModel=function(b){var d=c(b,a);a.models.push(d)},a.__init__=function(){jQuery.each(a.loadModels(),function(b,c){a.loadModel(c)})},a.__init__(),a.debug=function(){},a.do_rename_model=function(b,c){var d="rename_model_existing",e=a.models[b];a.existingModel(c)?a.messageService.simple_error("Error with Model Name","There is already a model with the name "+c).modal("show").attr("id",d):(e.set_name(c),a.updateModel(e),a.$apply())},a.rename_model=function(b){var c=a.models[b],d="rename_model",e=function(c){a.do_rename_model(b,c)};return a.messageService.simple_input("Rename model","Enter a new Model name",c.name,e,!0).modal("show").attr("id",d),d},a.add_relationship=function(b){const c=a.models[b],d=function(b){var d=b.find("input[name=name]").val().trim(),e=b.find("select[name=to]").val().trim(),f=!0;if(jQuery.each(a.built_in_models,function(a,b){e==a&&(f=!1)}),jQuery.each(a.models,function(a,b){e==b.name&&(f=!1)}),b.find("div.form-group-name").removeClass("has-error"),b.find("div.form-group-to").removeClass("has-error"),void 0===d||""===d)b.find("div.form-group-name").addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text("Field Required");else if(void 0===e||""===e)b.find("div.form-group-to").addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text("Field Required");else if(c.has_relationship(d))b.find("div.form-group-name").addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text('Field "'+d+'" exists');else{var g=b.find("select[name=type]").val(),h=b.find("input[name=opts]").val(),i=a.relationship_factory.make_relationship({name:d,type:g,opts:h,to:e,external_app:f});c.relationships.push(i),a.updateModel(c),a.$apply(),jQuery(".modal").modal("hide")}},e=jQuery("<form>"),f=jQuery("<div>").addClass("form-group form-group-name has-feedback").appendTo(e),g=jQuery("<div>").addClass("form-group form-group-to").appendTo(e),h=jQuery("<div>").addClass("form-group form-group-type").appendTo(e),i=jQuery("<div>").addClass("form-group form-group-args").appendTo(e);f.append(jQuery("<label>").text("Name")),f.append(jQuery("<input>").attr("name","name").addClass("form-control")),f.append(jQuery("<span>").text("error message").addClass("help-block hide"));const j=jQuery("<select>").attr("name","to").addClass("form-control"),k=jQuery("<optgroup>").attr("label","Django models");jQuery.each(a.built_in_models,function(a,b){k.append(jQuery("<option>").attr("val",a).text(a))}),j.append(k);const l=jQuery("<optgroup>").attr("label","Your App models");jQuery.each(a.models,function(a,b){l.append(jQuery("<option>").attr("val",b.name).text(b.name))}),j.append(l),g.append(jQuery("<label>").text("Relationship to Model")),g.append(j),g.append(jQuery("<p>").addClass("text-primary small clearfix").text("You can add external models (otherapp.models.Model1)").css("margin","4px"));const m=jQuery("<select>").attr("name","type");jQuery.each(a.relationship_factory.relationship_types(),function(a,b){m.append(jQuery("<option>").attr("val",b).text(b))}),h.append(jQuery("<label>").text("Relationship Type")),h.append(m),i.append(jQuery("<label>").text("Arguments")),i.append(jQuery("<input>").attr("name","opts").attr("placeholder","options").addClass("form-control")),j.select2({theme:"bootstrap",allowClear:!0,placeholder:"Select a model.",tags:!0,selectOnClose:!0}),m.select2({theme:"bootstrap"});const n="add_rel_"+c.name+"_"+b;return a.messageService.simple_form_no_dismiss("Add Relationship","",e,d).modal("show").attr("id",n).appendTo("body"),n},a.add_field=function(b){var c=a.models[b],d=function(b){var d=b.find("input[name=name]").val();if(void 0===d||""===d)b.find("div.form-group-name").addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text("Field Required");else if(c.has_field(d))b.find("div.form-group-name").addClass("has-error").append(jQuery("<i>").addClass("fa fa-times form-control-feedback")).find(".help-block").removeClass("hide").text('Field "'+d+'" exists');else{var e=b.find("select[name=type]").val(),f=b.find("input[name=opts]").val(),g=a.field_factory.make_field({name:d,type:e,opts:f});c.fields.push(g),a.updateModel(c),a.$apply(),jQuery(".modal").modal("hide")}},e=jQuery("<form>"),f=jQuery("<div>").addClass("form-group form-group-name  has-feedback").appendTo(e),g=jQuery("<div>").addClass("form-group form-group-type").appendTo(e),h=jQuery("<div>").addClass("form-group form-group-args").appendTo(e);f.append(jQuery("<label>").text("Name")),f.append(jQuery("<input>").attr("name","name").addClass("form-control")),f.append(jQuery("<span>").text("error message").addClass("help-block hide"));var i=jQuery("<select>").attr("name","type").addClass("form-control");jQuery.each(a.field_factory.field_types(),function(a,b){i.append(jQuery("<option>").attr("val",b).text(b))});var j=jQuery("<input>").attr("name","opts").attr("placeholder","options").addClass("form-control");g.append(jQuery("<label>").text("Field Type")),g.append(i),h.append(jQuery("<label>").text("Arguments")),h.append(j),i.change(function(){j.val(a.field_factory.default_field_args(i.val()))}),j.val(a.field_factory.default_field_args(i.val()));var k="add_field_"+c.name+"_"+b;return a.messageService.simple_form_no_dismiss("Add Field","",e,d).modal("show").attr("id",k).appendTo("body"),k},a.edit_relationship=function(b,c){var d=a.models[b].relationships[c],e=function(b){d.form_update(b),a.$apply(),jQuery(".modal").modal("hide")},f=d.$$hashKey||"edit_relationship_"+d.name;return a.messageService.simple_form("Edit Relationship '"+d.name+"'","",d.edit_form(a),e).modal("show").attr("id",f).appendTo("body"),f},a.edit_field=function(b,c){var d=a.models[b].fields[c],e=function(b){d.form_update(b),a.$apply(),jQuery(".modal").modal("hide")},f=d.$$hashKey||"edit_field_"+d.name;return a.messageService.simple_form("Edit field '"+d.name+"'","",d.edit_form(a),e).modal("show").attr("id",f).appendTo("body"),f},a.do_remove_new_model=function(b){a.new_models.splice(b,1),a.$apply()},a.remove_new_model=function(b){setTimeout(function(){a.do_remove_new_model(b)})},a.remove_relationship=function(b,c){var d=function(){a.models[b].relationships.splice(c,1),a.$apply()},e=a.models[b].relationships[c],f=e.$$hashKey||"remove_relationship_"+e.name;
return a.messageService.simple_confirm("Confirm","Remove the relationship '"+e.name+"'",d).modal("show").attr("id",f).appendTo("body"),f},a.do_remove_new_relationship=function(b,c){a.new_models[b].relationships.splice(c,1)},a.remove_new_relationship=function(b,c){setTimeout(function(){a.do_remove_new_relationship(b,c)})},a.do_remove_new_field=function(b,c){a.new_models[b].fields.splice(c,1),a.$apply()},a.remove_new_field=function(b,c){setTimeout(function(){a.do_remove_new_field(b,c)})},a.remove_field=function(b,c){var d=function(){a.models[b].fields.splice(c,1),a.$apply()},e=a.models[b].fields[c],f=e.$$hashKey||"remove_field_"+e.name;return a.messageService.simple_confirm("Confirm","Remove the field '"+e.name+"'",d).modal("show").attr("id",f).appendTo("body"),f},a.remove_model=function(b){var c=function(){a.models.splice(b,1),a.$apply()},d=a.models[b],e=d.$$hashKey||"remove_model_"+d.name;return a.messageService.simple_confirm("Confirm","Remove the model '"+d.name+"'",c).modal("show").modal("show").attr("id",e).appendTo("body"),e},a.model_highlight=function(b,c){var d=a.models[b].relationships[c];jQuery(".builder_model_"+d.to_clean()).addClass("builder_model_highlight")},a.model_unhighlight=function(){jQuery(".builder_model").removeClass("builder_model_highlight")},a.new_model_highlight=function(b,c){var d=a.new_models[b].relationships[c];jQuery(".builder_model_"+d.to_clean()).addClass("builder_model_highlight")},a.new_model_unhighlight=function(){jQuery(".builder_model").removeClass("builder_model_highlight")}}]),angular.module("builder.directives",[]).directive("appVersion",["version",function(a){return function(b,c,d){c.text(a)}}]),angular.module("builder.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]),angular.module("builder.services",[]).factory("ModelFactory",[ModelServiceFactory]).factory("ModelParser",[ModelParserFactory]).factory("MessageService",[MessageServiceFactory]).factory("FieldFactory",[FieldFactory]).factory("RelationshipFactory",[RelationshipFactory]).factory("RenderFactory",[ModelRenderFactory]).factory("TarballFactory",[TarballFactory]).value("version","0.1");